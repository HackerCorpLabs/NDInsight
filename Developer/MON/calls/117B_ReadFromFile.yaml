octal: 117B
name: ReadFromFile
short_names:
- RFILE
description: 'Reads any number of bytes from a file. The read operation must start at the beginning of
  a block. The file must be opened for random read access.


  - The standard block size is 512 bytes. You can change this with SetBlockSize. The first block is number
  0.

  - You may use access code D for direct transfer. Then the block size must be a multiple of the page
  size. The number of bytes to transfer must be a multiple of the block size.

  - Peripheral files are always read sequentially.

  - Data transfer across segment or RT common limits is illegal as this would be likely to result in inconsistent
  data.'
see_also:
- SetStartBlock
- SetBlockSize
- ReadDiskPage
- ReadBlock
- WriteBlock
- and WriteToFile
parameters:
- name: FileNo
  type: INTEGER2
  io: I
  description: File number. See OpenFile.
- name: WaitFlag
  type: INTEGER2
  io: I
  description: Wait flag. 0=suspend until complete, non-zero=continue (use AwaitFileTransfer to check).
- name: Buff
  type: BYTES
  io: O
  description: Buffer to receive transferred data (output). Must start on even byte address.
- name: BlockNo
  type: INTEGER2
  io: I
  description: Block number to start reading from. Use -1 to read the next block.
- name: NoOfBytes
  type: LONGINT
  io: I
  description: Number of bytes to read.
examples:
  pascal:
    available: true
    code: 'FileNo, WaitFlag, BlockNo : INTEGER2;

      Buff : ARRAY [0..15] OF RECORD...END;

      NoOfBytes : LONGINT;

      ...

      ReadFromFile(FileNo, WaitFlag, Buff, BlockNo, NoOfBytes);

      IF ErrCode <> 0 THEN ...'
  cobol:
    available: true
    code: "01 FileNo COMP.\n01 WaitFlag COMP.\n01 Buff.\n   02 array COMP OCCURS 256 TIMES.\n01 BlockNo\
      \ COMP.\n01 NoOfBytes COMP PIC S9(10).\n01 ErrCode COMP.\n...\nMONITOR-CALL \"ReadFromFile\" USING\
      \ FileNo, WaitFlag, Buff,\n                                BlockNo, NoOfBytes.\n\nCALL \"CbError\"\
      \ USING ErrCode.\nIF ErrCode NOT = 0 GO ..."
  fortran:
    available: true
    code: "INTEGER FileNo, WaitFlag, BlockNo\nINTEGER Buff(256)\nINTEGER*4 NoOfBytes\n...\nMonitor_Call('ReadFromFile',\
      \ FileNo, WaitFlag, Buff(1),\n                               BlockNo, NoOfBytes)\nC  IF (ErrCode\
      \ .NE. 0) THEN ..."
  planc:
    available: true
    code: 'INTEGER : FileNo, RetFlag, BlockNo

      BYTES : Buff(0:511)

      INTEGER4 : NoOfBytes

      ...

      ON ROUTINEERROR DO

      &nbsp;&nbsp;&nbsp;&nbsp;IF ErrCode >< 0 THEN ...

      ENDON

      Monitor_Call(''ReadfromFile'', FileNo, RetFlag, Buff(0), BlockNo, NoOfBytes)'
  assembly_500:
    available: true
    code: 'FileNo : W BLOCK 1

      WaitFlag : W BLOCK 1

      Buff : W BLOCK 256 %Must start on an even byte address.

      BlockNo : W BLOCK 1

      NoOfBytes : W BLOCK 1

      ErrCode : W BLOCK 1

      ReadFromFile : EQU 37B9 + 117B


      ...

      CALLG ReadfromFile, 5, FileNo, WaitFlag, Buff, BlockNo, NoOfBytes

      IF K GO ERROR

      ...

      ERROR : W1 =: ErrCode %ErrorCode in W1 register.'
    octal_definition: 37B9 + 117B
  mac:
    available: true
    code: 'LDA (PAR %Load register A with address of parameter list.

      MON 117 %Monitor call ReadFromFile.

      JAF ERROR %Handle error if register A is non-zero.

      ...

      ERROR, ... %Error number in register A.

      ...

      PAR, FILNO %File number returned from earlier call to OpenFile.

      RETUR %Return flag.

      BUFF %Buffer to receive data.

      BLKNO %Block number in file where data starts.

      COUNT %Number of words to be read.

      ...

      FILNO, ...

      RETUR, 0

      BUFF, 0

      *+400/ %Make a buffer of 256 words.

      BLKNO, ...

      COUNT, ...



      | ND-100 and ND-500 | All users | All programs |'
    mon_number: 117
compatibility:
  nd100: true
  nd500: true
  user_programs: true
  rt_programs: true
  system_programs: false
source:
  document: SINTRAN III Monitor Calls (ND-860228.2 EN)
  page: 399
  line: 18074
  scan_date: '2020'
  scanned_by: Jonny Oddene for Sintran Data
extraction:
  date: '2025-01-06'
  version: '1.0'
  validated: false
  ocr_corrected: false
