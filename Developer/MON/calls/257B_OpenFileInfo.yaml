# Monitor Call: 257B OpenFileInfo
# Extracted from: ND-860228.2 EN (SINTRAN III Monitor Calls)
# Source page: 370-371

octal: 257B
name: OpenFileInfo
short_names:
- FOPEN
- POPFN
description: |-
  Gets information about an open file. You specify the file name. The monitor call returns the file number and the access type. The logical device number of peripheral equipment is returned for peripheral files. Accepts COSMOS RFA.
see_also:
- OpenFile
parameters:
- name: FileName
  type: STRING
  io: I
  description: File name.
- name: FileType
  type: STRING
  io: I
  description: File type.
- name: FileNo
  type: INTEGER2
  io: O
  description: File number. If error return, this parameter contains the Logical Device Number (LDN) of peripheral device (only for peripheral files).
- name: AccessCode
  type: INTEGER2
  io: O
  description: Access code. 0 means read. 1 means write. 2 means read and write.
- name: DevNo
  type: INTEGER2
  io: O
  description: Logical device number of peripheral device. This is only relevant for peripheral files.
- name: ErrCode
  type: INTEGER2
  io: O
  description: Standard Error Code. See appendix A.
examples:
  pascal:
    available: true
    code: |-
      FileName : PACKED ARRAY [0..63] OF CHAR;
      FileType : PACKED ARRAY [0..3] OF CHAR;
      FileNo, AccessCode, DevNo : INTEGER2;
      ...
      GetOpenFileInfo(FileName, FileType, FileNo, AccessCode, DevNo);
      IF ErrCode <> 0 THEN ...
  cobol:
    available: true
    code: |-
      01 FileName PIC X(64).
      01 FileType PIC X(4).
      01 FileNo COMP.
      01 AccessCode COMP.
      01 DevNo COMP.
      01 ErrCode COMP.
      ...
      MONITOR-CALL "OpenFileInfo" USING FileName, FileType, FileNo,
                                       AccessCode, DevNo.
      CALL "CbError" USING ErrCode.
      IF ErrCode NOT = 0 GO ...
  fortran:
    available: true
    code: |-
      CHARACTER FileName*64, FileType*4
      INTEGER FileNo, AccessCode, DevNo
      ...
      Monitor_Call('OpenFileInfo', FileName(1:64), FileType(1:4), FileNo,
                                       AccessCode, DevNo)
      IF (ErrCode .NE. 0) THEN ...
  planc:
    available: true
    code: |-
      BYTES : FileName(0:63), FileType(0:3)
      INTEGER : FileNo, AccessCode, DevNo
      ...
      ON ROUTINEERROR DO
      IF ErrCode > 0 THEN ...
      ENDON
      Monitor_Call('OpenFileInfo', FileName, FileType, FileNo,&
      AccessCode, DevNo)
  assembly_500:
    available: true
    code: |-
      FileName    : STRINGDATA  'EXAMPLE'     %Get open-file info
      FileType    : STRINGDATA  'SYMB'        % of EXAMPLE:SYMB.
      FileNo      : W BLOCK  1                %ND-500 open file number.
      DevNo       : W BLOCK  1                %Peripheral device number.
      OpenCode    : W BLOCK  1                %Access code.
      S3No        : W BLOCK  1                %Optional SINTRAN III open file number as 6th param.
      ErrCode     : W BLOCK  1
      OpenFileInfo: EQU 37B9 + 257B
      ...
      CALLG OpenFileInfo, 5, FileName, FileType, FileNo, OpenCode, DevNo
      IF K GO ERROR
      ...
      ERROR : W1 =: ErrCode                %ErrorCode in W1 register.
  mac:
    available: true
    code: |-
      LDX   (FILE       %Address of string containing file name.
      LDA   (TYPE       %Address of string containing default file type.
      MON   257         %Monitor call OpenFileInfo.
      JMP   ERROR       %Error return from monitor call.
      STT   FILNO       %Normal return, store file number returned.
      STA   ACODE       %Store access code.
      COPY  SD DA
      STA   DEVNO       %Store peripheral dev. number, if peripheral file.
      ...
      ERROR, ...        %Handle error, register A: error number,
      ...               % register D: peripheral file number.
      FILE,  'EXAMPLE'  %Obtain file number for EXAMPLE:SYMB.
      TYPE,  'SYMB'
      FILNO, 0
      ACODE, ...
      DEVNO, ...
    mon_number: 257
compatibility:
  nd100: true
  nd500: true
  user_programs: true
  rt_programs: true
  system_programs: false
source:
  document: SINTRAN III Monitor Calls (ND-860228.2 EN)
  page: 370
  line: 16481
  scan_date: '2020'
  scanned_by: Jonny Oddene for Sintran Data
extraction:
  date: '2025-01-06'
  version: '1.0'
  validated: true
  ocr_corrected: true
  ocr_notes: Extracted from source document page 370-371
